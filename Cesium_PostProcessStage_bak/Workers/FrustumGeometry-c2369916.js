/**
 * Cesium - https://github.com/AnalyticalGraphicsInc/cesium
 *
 * Copyright 2011-2017 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md for full licensing details.
 */
define(["exports","./defined-b9ff0e39","./Check-e6691f86","./defaultValue-199f5aa8","./Math-2145e044","./Cartesian2-40ed5530","./defineProperties-ae15c9d5","./Transforms-94513c2d","./ComponentDatatype-9477db2c","./GeometryAttribute-4754007e","./GeometryAttributes-c3465b51","./Plane-297770b0","./VertexFormat-61bc2255"],function(e,D,m,E,i,M,t,V,k,F,P,f,d){"use strict";function h(e){this.planes=E.defaultValue(e,[])}var l=[new M.Cartesian3,new M.Cartesian3,new M.Cartesian3];M.Cartesian3.clone(M.Cartesian3.UNIT_X,l[0]),M.Cartesian3.clone(M.Cartesian3.UNIT_Y,l[1]),M.Cartesian3.clone(M.Cartesian3.UNIT_Z,l[2]);var p=new M.Cartesian3,c=new M.Cartesian3,u=new f.Plane(new M.Cartesian3(1,0,0),0);function a(e){e=E.defaultValue(e,E.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=E.defaultValue(e.near,1),this._near=this.near,this.far=E.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new h,this._orthographicMatrix=new V.Matrix4}function s(e){if(!(D.defined(e.right)&&D.defined(e.left)&&D.defined(e.top)&&D.defined(e.bottom)&&D.defined(e.near)&&D.defined(e.far)))throw new m.DeveloperError("right, left, top, bottom, near, or far parameters are not set.");if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right)throw new m.DeveloperError("right must be greater than left.");if(e.bottom>e.top)throw new m.DeveloperError("top must be greater than bottom.");if(e.near<=0||e.near>e.far)throw new m.DeveloperError("near must be greater than zero and less than far.");e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=V.Matrix4.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}h.fromBoundingSphere=function(e,t){if(!D.defined(e))throw new m.DeveloperError("boundingSphere is required.");D.defined(t)||(t=new h);var r=l.length,i=t.planes;i.length=2*r;for(var a=e.center,n=e.radius,o=0,s=0;s<r;++s){var f=l[s],u=i[o],d=i[o+1];D.defined(u)||(u=i[o]=new V.Cartesian4),D.defined(d)||(d=i[o+1]=new V.Cartesian4),M.Cartesian3.multiplyByScalar(f,-n,p),M.Cartesian3.add(a,p,p),u.x=f.x,u.y=f.y,u.z=f.z,u.w=-M.Cartesian3.dot(f,p),M.Cartesian3.multiplyByScalar(f,n,p),M.Cartesian3.add(a,p,p),d.x=-f.x,d.y=-f.y,d.z=-f.z,d.w=-M.Cartesian3.dot(M.Cartesian3.negate(f,c),p),o+=2}return t},h.prototype.computeVisibility=function(e){if(!D.defined(e))throw new m.DeveloperError("boundingVolume is required.");for(var t=this.planes,r=!1,i=0,a=t.length;i<a;++i){var n=e.intersectPlane(f.Plane.fromCartesian4(t[i],u));if(n===V.Intersect.OUTSIDE)return V.Intersect.OUTSIDE;n===V.Intersect.INTERSECTING&&(r=!0)}return r?V.Intersect.INTERSECTING:V.Intersect.INSIDE},h.prototype.computeVisibilityWithPlaneMask=function(e,t){if(!D.defined(e))throw new m.DeveloperError("boundingVolume is required.");if(!D.defined(t))throw new m.DeveloperError("parentPlaneMask is required.");if(t===h.MASK_OUTSIDE||t===h.MASK_INSIDE)return t;for(var r=h.MASK_INSIDE,i=this.planes,a=0,n=i.length;a<n;++a){var o=a<31?1<<a:0;if(!(a<31&&0==(t&o))){var s=e.intersectPlane(f.Plane.fromCartesian4(i[a],u));if(s===V.Intersect.OUTSIDE)return h.MASK_OUTSIDE;s===V.Intersect.INTERSECTING&&(r|=o)}}return r},h.MASK_OUTSIDE=4294967295,h.MASK_INSIDE=0,h.MASK_INDETERMINATE=2147483647,t.defineProperties(a.prototype,{projectionMatrix:{get:function(){return s(this),this._orthographicMatrix}}});var C=new M.Cartesian3,w=new M.Cartesian3,v=new M.Cartesian3,g=new M.Cartesian3;function _(e){e=E.defaultValue(e,E.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new a,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=E.defaultValue(e.near,1),this._near=this.near,this.far=E.defaultValue(e.far,5e8),this._far=this.far}function n(e){if(!(D.defined(e.width)&&D.defined(e.aspectRatio)&&D.defined(e.near)&&D.defined(e.far)))throw new m.DeveloperError("width, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0)throw new m.DeveloperError("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new m.DeveloperError("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;var r=1/e.aspectRatio;t.right=.5*e.width,t.left=-t.right,t.top=r*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}function o(e){e=E.defaultValue(e,E.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=E.defaultValue(e.near,1),this._near=this.near,this.far=E.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new h,this._perspectiveMatrix=new V.Matrix4,this._infinitePerspective=new V.Matrix4}function y(e){if(!(D.defined(e.right)&&D.defined(e.left)&&D.defined(e.top)&&D.defined(e.bottom)&&D.defined(e.near)&&D.defined(e.far)))throw new m.DeveloperError("right, left, top, bottom, near, or far parameters are not set.");var t=e.top,r=e.bottom,i=e.right,a=e.left,n=e.near,o=e.far;if(t!==e._top||r!==e._bottom||a!==e._left||i!==e._right||n!==e._near||o!==e._far){if(e.near<=0||e.near>e.far)throw new m.DeveloperError("near must be greater than zero and less than far.");e._left=a,e._right=i,e._top=t,e._bottom=r,e._near=n,e._far=o,e._perspectiveMatrix=V.Matrix4.computePerspectiveOffCenter(a,i,r,t,n,o,e._perspectiveMatrix),e._infinitePerspective=V.Matrix4.computeInfinitePerspectiveOffCenter(a,i,r,t,n,e._infinitePerspective)}}a.prototype.computeCullingVolume=function(e,t,r){if(!D.defined(e))throw new m.DeveloperError("position is required.");if(!D.defined(t))throw new m.DeveloperError("direction is required.");if(!D.defined(r))throw new m.DeveloperError("up is required.");var i=this._cullingVolume.planes,a=this.top,n=this.bottom,o=this.right,s=this.left,f=this.near,u=this.far,d=M.Cartesian3.cross(t,r,C);M.Cartesian3.normalize(d,d);var h=w;M.Cartesian3.multiplyByScalar(t,f,h),M.Cartesian3.add(e,h,h);var l=v;M.Cartesian3.multiplyByScalar(d,s,l),M.Cartesian3.add(h,l,l);var p=i[0];return D.defined(p)||(p=i[0]=new V.Cartesian4),p.x=d.x,p.y=d.y,p.z=d.z,p.w=-M.Cartesian3.dot(d,l),M.Cartesian3.multiplyByScalar(d,o,l),M.Cartesian3.add(h,l,l),p=i[1],D.defined(p)||(p=i[1]=new V.Cartesian4),p.x=-d.x,p.y=-d.y,p.z=-d.z,p.w=-M.Cartesian3.dot(M.Cartesian3.negate(d,g),l),M.Cartesian3.multiplyByScalar(r,n,l),M.Cartesian3.add(h,l,l),p=i[2],D.defined(p)||(p=i[2]=new V.Cartesian4),p.x=r.x,p.y=r.y,p.z=r.z,p.w=-M.Cartesian3.dot(r,l),M.Cartesian3.multiplyByScalar(r,a,l),M.Cartesian3.add(h,l,l),p=i[3],D.defined(p)||(p=i[3]=new V.Cartesian4),p.x=-r.x,p.y=-r.y,p.z=-r.z,p.w=-M.Cartesian3.dot(M.Cartesian3.negate(r,g),l),p=i[4],D.defined(p)||(p=i[4]=new V.Cartesian4),p.x=t.x,p.y=t.y,p.z=t.z,p.w=-M.Cartesian3.dot(t,h),M.Cartesian3.multiplyByScalar(t,u,l),M.Cartesian3.add(e,l,l),p=i[5],D.defined(p)||(p=i[5]=new V.Cartesian4),p.x=-t.x,p.y=-t.y,p.z=-t.z,p.w=-M.Cartesian3.dot(M.Cartesian3.negate(t,g),l),this._cullingVolume},a.prototype.getPixelDimensions=function(e,t,r,i,a){if(s(this),i instanceof M.Cartesian2&&(a=i,i=1,V.deprecationWarning("getPixelDimensions-parameter-change","getPixelDimensions now takes a pixelRatio argument before the result argument in Cesium 1.63. The previous function definition will no longer work in 1.65.")),!D.defined(e)||!D.defined(t))throw new m.DeveloperError("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new m.DeveloperError("drawingBufferWidth must be greater than zero.");if(t<=0)throw new m.DeveloperError("drawingBufferHeight must be greater than zero.");if(!D.defined(r))throw new m.DeveloperError("distance is required.");if(!D.defined(i))throw new m.DeveloperError("pixelRatio is required.");if(i<=0)throw new m.DeveloperError("pixelRatio must be greater than zero.");if(!D.defined(a))throw new m.DeveloperError("A result object is required.");var n=i*(this.right-this.left)/e,o=i*(this.top-this.bottom)/t;return a.x=n,a.y=o,a},a.prototype.clone=function(e){return D.defined(e)||(e=new a),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},a.prototype.equals=function(e){return D.defined(e)&&e instanceof a&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},a.prototype.equalsEpsilon=function(e,t,r){return e===this||D.defined(e)&&e instanceof a&&i.CesiumMath.equalsEpsilon(this.right,e.right,t,r)&&i.CesiumMath.equalsEpsilon(this.left,e.left,t,r)&&i.CesiumMath.equalsEpsilon(this.top,e.top,t,r)&&i.CesiumMath.equalsEpsilon(this.bottom,e.bottom,t,r)&&i.CesiumMath.equalsEpsilon(this.near,e.near,t,r)&&i.CesiumMath.equalsEpsilon(this.far,e.far,t,r)},_.packedLength=4,_.pack=function(e,t,r){return m.Check.typeOf.object("value",e),m.Check.defined("array",t),r=E.defaultValue(r,0),t[r++]=e.width,t[r++]=e.aspectRatio,t[r++]=e.near,t[r]=e.far,t},_.unpack=function(e,t,r){return m.Check.defined("array",e),t=E.defaultValue(t,0),D.defined(r)||(r=new _),r.width=e[t++],r.aspectRatio=e[t++],r.near=e[t++],r.far=e[t],r},t.defineProperties(_.prototype,{projectionMatrix:{get:function(){return n(this),this._offCenterFrustum.projectionMatrix}}}),_.prototype.computeCullingVolume=function(e,t,r){return n(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},_.prototype.getPixelDimensions=function(e,t,r,i,a){return n(this),i instanceof M.Cartesian2&&(a=i,i=1,V.deprecationWarning("getPixelDimensions-parameter-change","getPixelDimensions now takes a pixelRatio argument before the result argument in Cesium 1.63. The previous function definition will no longer work in 1.65.")),this._offCenterFrustum.getPixelDimensions(e,t,r,i,a)},_.prototype.clone=function(e){return D.defined(e)||(e=new _),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},_.prototype.equals=function(e){return!!(D.defined(e)&&e instanceof _)&&(n(this),n(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},_.prototype.equalsEpsilon=function(e,t,r){return!!(D.defined(e)&&e instanceof _)&&(n(this),n(e),i.CesiumMath.equalsEpsilon(this.width,e.width,t,r)&&i.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,r)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,r))},t.defineProperties(o.prototype,{projectionMatrix:{get:function(){return y(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return y(this),this._infinitePerspective}}});var x=new M.Cartesian3,b=new M.Cartesian3,R=new M.Cartesian3,z=new M.Cartesian3;function O(e){e=E.defaultValue(e,E.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new o,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=E.defaultValue(e.near,1),this._near=this.near,this.far=E.defaultValue(e.far,5e8),this._far=this.far,this.xOffset=E.defaultValue(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=E.defaultValue(e.yOffset,0),this._yOffset=this.yOffset}function q(e){if(!(D.defined(e.fov)&&D.defined(e.aspectRatio)&&D.defined(e.near)&&D.defined(e.far)))throw new m.DeveloperError("fov, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new m.DeveloperError("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new m.DeveloperError("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new m.DeveloperError("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset}}o.prototype.computeCullingVolume=function(e,t,r){if(!D.defined(e))throw new m.DeveloperError("position is required.");if(!D.defined(t))throw new m.DeveloperError("direction is required.");if(!D.defined(r))throw new m.DeveloperError("up is required.");var i=this._cullingVolume.planes,a=this.top,n=this.bottom,o=this.right,s=this.left,f=this.near,u=this.far,d=M.Cartesian3.cross(t,r,x),h=b;M.Cartesian3.multiplyByScalar(t,f,h),M.Cartesian3.add(e,h,h);var l=R;M.Cartesian3.multiplyByScalar(t,u,l),M.Cartesian3.add(e,l,l);var p=z;M.Cartesian3.multiplyByScalar(d,s,p),M.Cartesian3.add(h,p,p),M.Cartesian3.subtract(p,e,p),M.Cartesian3.normalize(p,p),M.Cartesian3.cross(p,r,p),M.Cartesian3.normalize(p,p);var c=i[0];return D.defined(c)||(c=i[0]=new V.Cartesian4),c.x=p.x,c.y=p.y,c.z=p.z,c.w=-M.Cartesian3.dot(p,e),M.Cartesian3.multiplyByScalar(d,o,p),M.Cartesian3.add(h,p,p),M.Cartesian3.subtract(p,e,p),M.Cartesian3.cross(r,p,p),M.Cartesian3.normalize(p,p),c=i[1],D.defined(c)||(c=i[1]=new V.Cartesian4),c.x=p.x,c.y=p.y,c.z=p.z,c.w=-M.Cartesian3.dot(p,e),M.Cartesian3.multiplyByScalar(r,n,p),M.Cartesian3.add(h,p,p),M.Cartesian3.subtract(p,e,p),M.Cartesian3.cross(d,p,p),M.Cartesian3.normalize(p,p),c=i[2],D.defined(c)||(c=i[2]=new V.Cartesian4),c.x=p.x,c.y=p.y,c.z=p.z,c.w=-M.Cartesian3.dot(p,e),M.Cartesian3.multiplyByScalar(r,a,p),M.Cartesian3.add(h,p,p),M.Cartesian3.subtract(p,e,p),M.Cartesian3.cross(p,d,p),M.Cartesian3.normalize(p,p),c=i[3],D.defined(c)||(c=i[3]=new V.Cartesian4),c.x=p.x,c.y=p.y,c.z=p.z,c.w=-M.Cartesian3.dot(p,e),c=i[4],D.defined(c)||(c=i[4]=new V.Cartesian4),c.x=t.x,c.y=t.y,c.z=t.z,c.w=-M.Cartesian3.dot(t,h),M.Cartesian3.negate(t,p),c=i[5],D.defined(c)||(c=i[5]=new V.Cartesian4),c.x=p.x,c.y=p.y,c.z=p.z,c.w=-M.Cartesian3.dot(p,l),this._cullingVolume},o.prototype.getPixelDimensions=function(e,t,r,i,a){if(y(this),i instanceof M.Cartesian2&&(a=i,i=1,V.deprecationWarning("getPixelDimensions-parameter-change","getPixelDimensions now takes a pixelRatio argument before the result argument in Cesium 1.63. The previous function definition will no longer work in 1.65.")),!D.defined(e)||!D.defined(t))throw new m.DeveloperError("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new m.DeveloperError("drawingBufferWidth must be greater than zero.");if(t<=0)throw new m.DeveloperError("drawingBufferHeight must be greater than zero.");if(!D.defined(r))throw new m.DeveloperError("distance is required.");if(!D.defined(i))throw new m.DeveloperError("pixelRatio is required");if(i<=0)throw new m.DeveloperError("pixelRatio must be greater than zero.");if(!D.defined(a))throw new m.DeveloperError("A result object is required.");var n=1/this.near,o=this.top*n,s=2*i*r*o/t,f=2*i*r*(o=this.right*n)/e;return a.x=f,a.y=s,a},o.prototype.clone=function(e){return D.defined(e)||(e=new o),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},o.prototype.equals=function(e){return D.defined(e)&&e instanceof o&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},o.prototype.equalsEpsilon=function(e,t,r){return e===this||D.defined(e)&&e instanceof o&&i.CesiumMath.equalsEpsilon(this.right,e.right,t,r)&&i.CesiumMath.equalsEpsilon(this.left,e.left,t,r)&&i.CesiumMath.equalsEpsilon(this.top,e.top,t,r)&&i.CesiumMath.equalsEpsilon(this.bottom,e.bottom,t,r)&&i.CesiumMath.equalsEpsilon(this.near,e.near,t,r)&&i.CesiumMath.equalsEpsilon(this.far,e.far,t,r)},O.packedLength=6,O.pack=function(e,t,r){return m.Check.typeOf.object("value",e),m.Check.defined("array",t),r=E.defaultValue(r,0),t[r++]=e.fov,t[r++]=e.aspectRatio,t[r++]=e.near,t[r++]=e.far,t[r++]=e.xOffset,t[r]=e.yOffset,t},O.unpack=function(e,t,r){return m.Check.defined("array",e),t=E.defaultValue(t,0),D.defined(r)||(r=new O),r.fov=e[t++],r.aspectRatio=e[t++],r.near=e[t++],r.far=e[t++],r.xOffset=e[t++],r.yOffset=e[t],r},t.defineProperties(O.prototype,{projectionMatrix:{get:function(){return q(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return q(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return q(this),this._fovy}},sseDenominator:{get:function(){return q(this),this._sseDenominator}}}),O.prototype.computeCullingVolume=function(e,t,r){return q(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},O.prototype.getPixelDimensions=function(e,t,r,i,a){return q(this),i instanceof M.Cartesian2&&(a=i,i=1,V.deprecationWarning("getPixelDimensions-parameter-change","getPixelDimensions now takes a pixelRatio argument before the result argument in Cesium 1.63. The previous function definition will no longer work in 1.65.")),this._offCenterFrustum.getPixelDimensions(e,t,r,i,a)},O.prototype.clone=function(e){return D.defined(e)||(e=new O),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},O.prototype.equals=function(e){return!!(D.defined(e)&&e instanceof O)&&(q(this),q(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},O.prototype.equalsEpsilon=function(e,t,r){return!!(D.defined(e)&&e instanceof O)&&(q(this),q(e),i.CesiumMath.equalsEpsilon(this.fov,e.fov,t,r)&&i.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,r)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,r))};function T(e){m.Check.typeOf.object("options",e),m.Check.typeOf.object("options.frustum",e.frustum),m.Check.typeOf.object("options.origin",e.origin),m.Check.typeOf.object("options.orientation",e.orientation);var t,r,i=e.frustum,a=e.orientation,n=e.origin,o=E.defaultValue(e.vertexFormat,d.VertexFormat.DEFAULT),s=E.defaultValue(e._drawNearPlane,!0);i instanceof O?(t=0,r=O.packedLength):i instanceof _&&(t=1,r=_.packedLength),this._frustumType=t,this._frustum=i.clone(),this._origin=M.Cartesian3.clone(n),this._orientation=V.Quaternion.clone(a),this._drawNearPlane=s,this._vertexFormat=o,this._workerName="createFrustumGeometry",this.packedLength=2+r+M.Cartesian3.packedLength+V.Quaternion.packedLength+d.VertexFormat.packedLength}T.pack=function(e,t,r){m.Check.typeOf.object("value",e),m.Check.defined("array",t),r=E.defaultValue(r,0);var i=e._frustumType,a=e._frustum;return 0===(t[r++]=i)?(O.pack(a,t,r),r+=O.packedLength):(_.pack(a,t,r),r+=_.packedLength),M.Cartesian3.pack(e._origin,t,r),r+=M.Cartesian3.packedLength,V.Quaternion.pack(e._orientation,t,r),r+=V.Quaternion.packedLength,d.VertexFormat.pack(e._vertexFormat,t,r),t[r+=d.VertexFormat.packedLength]=e._drawNearPlane?1:0,t};var S=new O,A=new _,I=new V.Quaternion,B=new M.Cartesian3,L=new d.VertexFormat;function N(e,t,r,i,a,n,o,s){for(var f=e/3*2,u=0;u<4;++u)D.defined(t)&&(t[e]=n.x,t[e+1]=n.y,t[e+2]=n.z),D.defined(r)&&(r[e]=o.x,r[e+1]=o.y,r[e+2]=o.z),D.defined(i)&&(i[e]=s.x,i[e+1]=s.y,i[e+2]=s.z),e+=3;a[f]=0,a[1+f]=0,a[2+f]=1,a[3+f]=0,a[4+f]=1,a[5+f]=1,a[6+f]=0,a[7+f]=1}T.unpack=function(e,t,r){m.Check.defined("array",e),t=E.defaultValue(t,0);var i,a=e[t++];0===a?(i=O.unpack(e,t,S),t+=O.packedLength):(i=_.unpack(e,t,A),t+=_.packedLength);var n=M.Cartesian3.unpack(e,t,B);t+=M.Cartesian3.packedLength;var o=V.Quaternion.unpack(e,t,I);t+=V.Quaternion.packedLength;var s=d.VertexFormat.unpack(e,t,L),f=1===e[t+=d.VertexFormat.packedLength];if(!D.defined(r))return new T({frustum:i,origin:n,orientation:o,vertexFormat:s,_drawNearPlane:f});var u=a===r._frustumType?r._frustum:void 0;return r._frustum=i.clone(u),r._frustumType=a,r._origin=M.Cartesian3.clone(n,r._origin),r._orientation=V.Quaternion.clone(o,r._orientation),r._vertexFormat=d.VertexFormat.clone(s,r._vertexFormat),r._drawNearPlane=f,r};var j=new V.Matrix3,G=new V.Matrix4,U=new V.Matrix4,Q=new M.Cartesian3,W=new M.Cartesian3,K=new M.Cartesian3,Y=new M.Cartesian3,H=new M.Cartesian3,J=new M.Cartesian3,X=new Array(3),Z=new Array(4);Z[0]=new V.Cartesian4(-1,-1,1,1),Z[1]=new V.Cartesian4(1,-1,1,1),Z[2]=new V.Cartesian4(1,1,1,1),Z[3]=new V.Cartesian4(-1,1,1,1);for(var $=new Array(4),r=0;r<4;++r)$[r]=new V.Cartesian4;T._computeNearFarPlanes=function(e,t,r,i,a,n,o,s){var f=V.Matrix3.fromQuaternion(t,j),u=E.defaultValue(n,Q),d=E.defaultValue(o,W),h=E.defaultValue(s,K);u=V.Matrix3.getColumn(f,0,u),d=V.Matrix3.getColumn(f,1,d),h=V.Matrix3.getColumn(f,2,h),M.Cartesian3.normalize(u,u),M.Cartesian3.normalize(d,d),M.Cartesian3.normalize(h,h),M.Cartesian3.negate(u,u);var l,p,c=V.Matrix4.computeView(e,h,d,u,G);if(0===r){var m=i.projectionMatrix,C=V.Matrix4.multiply(m,c,U);p=V.Matrix4.inverse(C,U)}else l=V.Matrix4.inverseTransformation(c,U);D.defined(p)?(X[0]=i.near,X[1]=i.far):(X[0]=0,X[1]=i.near,X[2]=i.far);for(var w=0;w<2;++w)for(var v=0;v<4;++v){var g=V.Cartesian4.clone(Z[v],$[v]);if(D.defined(p)){var _=1/(g=V.Matrix4.multiplyByVector(p,g,g)).w;M.Cartesian3.multiplyByScalar(g,_,g),M.Cartesian3.subtract(g,e,g),M.Cartesian3.normalize(g,g);var y=M.Cartesian3.dot(h,g);M.Cartesian3.multiplyByScalar(g,X[w]/y,g),M.Cartesian3.add(g,e,g)}else{D.defined(i._offCenterFrustum)&&(i=i._offCenterFrustum);var x=X[w],b=X[w+1];g.x=.5*(g.x*(i.right-i.left)+i.left+i.right),g.y=.5*(g.y*(i.top-i.bottom)+i.bottom+i.top),g.z=.5*(g.z*(x-b)-x-b),g.w=1,V.Matrix4.multiplyByVector(l,g,g)}a[12*w+3*v]=g.x,a[12*w+3*v+1]=g.y,a[12*w+3*v+2]=g.z}},T.createGeometry=function(e){var t=e._frustumType,r=e._frustum,i=e._origin,a=e._orientation,n=e._drawNearPlane,o=e._vertexFormat,s=n?6:5,f=new Float64Array(72);T._computeNearFarPlanes(i,a,t,r,f);var u=24;f[u]=f[12],f[u+1]=f[13],f[u+2]=f[14],f[u+3]=f[0],f[u+4]=f[1],f[u+5]=f[2],f[u+6]=f[9],f[u+7]=f[10],f[u+8]=f[11],f[u+9]=f[21],f[u+10]=f[22],f[u+11]=f[23],f[u+=12]=f[15],f[u+1]=f[16],f[u+2]=f[17],f[u+3]=f[3],f[u+4]=f[4],f[u+5]=f[5],f[u+6]=f[0],f[u+7]=f[1],f[u+8]=f[2],f[u+9]=f[12],f[u+10]=f[13],f[u+11]=f[14],f[u+=12]=f[3],f[u+1]=f[4],f[u+2]=f[5],f[u+3]=f[15],f[u+4]=f[16],f[u+5]=f[17],f[u+6]=f[18],f[u+7]=f[19],f[u+8]=f[20],f[u+9]=f[6],f[u+10]=f[7],f[u+11]=f[8],f[u+=12]=f[6],f[u+1]=f[7],f[u+2]=f[8],f[u+3]=f[18],f[u+4]=f[19],f[u+5]=f[20],f[u+6]=f[21],f[u+7]=f[22],f[u+8]=f[23],f[u+9]=f[9],f[u+10]=f[10],f[u+11]=f[11],n||(f=f.subarray(12));var d=new P.GeometryAttributes({position:new F.GeometryAttribute({componentDatatype:k.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:f})});if(D.defined(o.normal)||D.defined(o.tangent)||D.defined(o.bitangent)||D.defined(o.st)){var h=D.defined(o.normal)?new Float32Array(12*s):void 0,l=D.defined(o.tangent)?new Float32Array(12*s):void 0,p=D.defined(o.bitangent)?new Float32Array(12*s):void 0,c=D.defined(o.st)?new Float32Array(8*s):void 0,m=Q,C=W,w=K,v=M.Cartesian3.negate(m,Y),g=M.Cartesian3.negate(C,H),_=M.Cartesian3.negate(w,J);u=0,n&&(N(u,h,l,p,c,_,m,C),u+=12),N(u,h,l,p,c,w,v,C),N(u+=12,h,l,p,c,v,_,C),N(u+=12,h,l,p,c,g,_,v),N(u+=12,h,l,p,c,m,w,C),N(u+=12,h,l,p,c,C,w,v),D.defined(h)&&(d.normal=new F.GeometryAttribute({componentDatatype:k.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:h})),D.defined(l)&&(d.tangent=new F.GeometryAttribute({componentDatatype:k.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:l})),D.defined(p)&&(d.bitangent=new F.GeometryAttribute({componentDatatype:k.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:p})),D.defined(c)&&(d.st=new F.GeometryAttribute({componentDatatype:k.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:c}))}for(var y=new Uint16Array(6*s),x=0;x<s;++x){var b=6*x,E=4*x;y[b]=E,y[1+b]=1+E,y[2+b]=2+E,y[3+b]=E,y[4+b]=2+E,y[5+b]=3+E}return new F.Geometry({attributes:d,indices:y,primitiveType:F.PrimitiveType.TRIANGLES,boundingSphere:V.BoundingSphere.fromVertices(f)})},e.FrustumGeometry=T,e.OrthographicFrustum=_,e.PerspectiveFrustum=O});
