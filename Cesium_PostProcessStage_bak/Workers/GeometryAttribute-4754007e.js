/**
 * Cesium - https://github.com/AnalyticalGraphicsInc/cesium
 *
 * Copyright 2011-2017 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md for full licensing details.
 */
define(["exports","./defined-b9ff0e39","./Check-e6691f86","./freezeObject-2d5b18ce","./defaultValue-199f5aa8","./Cartesian2-40ed5530","./defineProperties-ae15c9d5","./Transforms-94513c2d","./WebGLConstants-554ddbe2"],function(e,i,u,t,a,v,r,L,n){"use strict";var o=t.freezeObject({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3});function A(e,t,r,n){this[0]=a.defaultValue(e,0),this[1]=a.defaultValue(r,0),this[2]=a.defaultValue(t,0),this[3]=a.defaultValue(n,0)}A.packedLength=4,A.pack=function(e,t,r){return u.Check.typeOf.object("value",e),u.Check.defined("array",t),r=a.defaultValue(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t},A.unpack=function(e,t,r){return u.Check.defined("array",e),t=a.defaultValue(t,0),i.defined(r)||(r=new A),r[0]=e[t++],r[1]=e[t++],r[2]=e[t++],r[3]=e[t++],r},A.clone=function(e,t){if(i.defined(e))return i.defined(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new A(e[0],e[2],e[1],e[3])},A.fromArray=function(e,t,r){return u.Check.defined("array",e),t=a.defaultValue(t,0),i.defined(r)||(r=new A),r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r},A.fromColumnMajorArray=function(e,t){return u.Check.defined("values",e),A.clone(e,t)},A.fromRowMajorArray=function(e,t){return u.Check.defined("values",e),i.defined(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new A(e[0],e[1],e[2],e[3])},A.fromScale=function(e,t){return u.Check.typeOf.object("scale",e),i.defined(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new A(e.x,0,0,e.y)},A.fromUniformScale=function(e,t){return u.Check.typeOf.number("scale",e),i.defined(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new A(e,0,0,e)},A.fromRotation=function(e,t){u.Check.typeOf.number("angle",e);var r=Math.cos(e),n=Math.sin(e);return i.defined(t)?(t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t):new A(r,-n,n,r)},A.toArray=function(e,t){return u.Check.typeOf.object("matrix",e),i.defined(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},A.getElementIndex=function(e,t){return u.Check.typeOf.number.greaterThanOrEquals("row",t,0),u.Check.typeOf.number.lessThanOrEquals("row",t,1),u.Check.typeOf.number.greaterThanOrEquals("column",e,0),u.Check.typeOf.number.lessThanOrEquals("column",e,1),2*e+t},A.getColumn=function(e,t,r){u.Check.typeOf.object("matrix",e),u.Check.typeOf.number.greaterThanOrEquals("index",t,0),u.Check.typeOf.number.lessThanOrEquals("index",t,1),u.Check.typeOf.object("result",r);var n=2*t,a=e[n],i=e[1+n];return r.x=a,r.y=i,r},A.setColumn=function(e,t,r,n){u.Check.typeOf.object("matrix",e),u.Check.typeOf.number.greaterThanOrEquals("index",t,0),u.Check.typeOf.number.lessThanOrEquals("index",t,1),u.Check.typeOf.object("cartesian",r),u.Check.typeOf.object("result",n);var a=2*t;return(n=A.clone(e,n))[a]=r.x,n[1+a]=r.y,n},A.getRow=function(e,t,r){u.Check.typeOf.object("matrix",e),u.Check.typeOf.number.greaterThanOrEquals("index",t,0),u.Check.typeOf.number.lessThanOrEquals("index",t,1),u.Check.typeOf.object("result",r);var n=e[t],a=e[t+2];return r.x=n,r.y=a,r},A.setRow=function(e,t,r,n){return u.Check.typeOf.object("matrix",e),u.Check.typeOf.number.greaterThanOrEquals("index",t,0),u.Check.typeOf.number.lessThanOrEquals("index",t,1),u.Check.typeOf.object("cartesian",r),u.Check.typeOf.object("result",n),(n=A.clone(e,n))[t]=r.x,n[t+2]=r.y,n};var c=new v.Cartesian2;A.getScale=function(e,t){return u.Check.typeOf.object("matrix",e),u.Check.typeOf.object("result",t),t.x=v.Cartesian2.magnitude(v.Cartesian2.fromElements(e[0],e[1],c)),t.y=v.Cartesian2.magnitude(v.Cartesian2.fromElements(e[2],e[3],c)),t};var s=new v.Cartesian2;A.getMaximumScale=function(e){return A.getScale(e,s),v.Cartesian2.maximumComponent(s)},A.multiply=function(e,t,r){u.Check.typeOf.object("left",e),u.Check.typeOf.object("right",t),u.Check.typeOf.object("result",r);var n=e[0]*t[0]+e[2]*t[1],a=e[0]*t[2]+e[2]*t[3],i=e[1]*t[0]+e[3]*t[1],o=e[1]*t[2]+e[3]*t[3];return r[0]=n,r[1]=i,r[2]=a,r[3]=o,r},A.add=function(e,t,r){return u.Check.typeOf.object("left",e),u.Check.typeOf.object("right",t),u.Check.typeOf.object("result",r),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r},A.subtract=function(e,t,r){return u.Check.typeOf.object("left",e),u.Check.typeOf.object("right",t),u.Check.typeOf.object("result",r),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r},A.multiplyByVector=function(e,t,r){u.Check.typeOf.object("matrix",e),u.Check.typeOf.object("cartesian",t),u.Check.typeOf.object("result",r);var n=e[0]*t.x+e[2]*t.y,a=e[1]*t.x+e[3]*t.y;return r.x=n,r.y=a,r},A.multiplyByScalar=function(e,t,r){return u.Check.typeOf.object("matrix",e),u.Check.typeOf.number("scalar",t),u.Check.typeOf.object("result",r),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r},A.multiplyByScale=function(e,t,r){return u.Check.typeOf.object("matrix",e),u.Check.typeOf.object("scale",t),u.Check.typeOf.object("result",r),r[0]=e[0]*t.x,r[1]=e[1]*t.x,r[2]=e[2]*t.y,r[3]=e[3]*t.y,r},A.negate=function(e,t){return u.Check.typeOf.object("matrix",e),u.Check.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},A.transpose=function(e,t){u.Check.typeOf.object("matrix",e),u.Check.typeOf.object("result",t);var r=e[0],n=e[2],a=e[1],i=e[3];return t[0]=r,t[1]=n,t[2]=a,t[3]=i,t},A.abs=function(e,t){return u.Check.typeOf.object("matrix",e),u.Check.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},A.equals=function(e,t){return e===t||i.defined(e)&&i.defined(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},A.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]},A.equalsEpsilon=function(e,t,r){return u.Check.typeOf.number("epsilon",r),e===t||i.defined(e)&&i.defined(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r},A.IDENTITY=t.freezeObject(new A(1,0,0,1)),A.ZERO=t.freezeObject(new A(0,0,0,0)),A.COLUMN0ROW0=0,A.COLUMN0ROW1=1,A.COLUMN1ROW0=2,A.COLUMN1ROW1=3,r.defineProperties(A.prototype,{length:{get:function(){return A.packedLength}}}),A.prototype.clone=function(e){return A.clone(this,e)},A.prototype.equals=function(e){return A.equals(this,e)},A.prototype.equalsEpsilon=function(e,t){return A.equalsEpsilon(this,e,t)},A.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n("+this[1]+", "+this[3]+")"};var f={POINTS:n.WebGLConstants.POINTS,LINES:n.WebGLConstants.LINES,LINE_LOOP:n.WebGLConstants.LINE_LOOP,LINE_STRIP:n.WebGLConstants.LINE_STRIP,TRIANGLES:n.WebGLConstants.TRIANGLES,TRIANGLE_STRIP:n.WebGLConstants.TRIANGLE_STRIP,TRIANGLE_FAN:n.WebGLConstants.TRIANGLE_FAN,validate:function(e){return e===f.POINTS||e===f.LINES||e===f.LINE_LOOP||e===f.LINE_STRIP||e===f.TRIANGLES||e===f.TRIANGLE_STRIP||e===f.TRIANGLE_FAN}},l=t.freezeObject(f);function h(e){e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT),u.Check.typeOf.object("options.attributes",e.attributes),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=a.defaultValue(e.primitiveType,l.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=a.defaultValue(e.geometryType,o.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}h.computeNumberOfVertices=function(e){u.Check.typeOf.object("geometry",e);var t=-1;for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)&&i.defined(e.attributes[r])&&i.defined(e.attributes[r].values)){var n=e.attributes[r],a=n.values.length/n.componentsPerAttribute;if(t!==a&&-1!==t)throw new u.DeveloperError("All attribute lists must have the same number of attributes.");t=a}return t};var S=new v.Cartographic,P=new v.Cartesian3,M=new L.Matrix4,R=[new v.Cartographic,new v.Cartographic,new v.Cartographic],V=[new v.Cartesian2,new v.Cartesian2,new v.Cartesian2],G=[new v.Cartesian2,new v.Cartesian2,new v.Cartesian2],q=new v.Cartesian3,_=new L.Quaternion,W=new L.Matrix4,D=new A;h._textureCoordinateRotationPoints=function(e,t,r,n){var a,i=v.Rectangle.center(n,S),o=v.Cartographic.toCartesian(i,r,P),u=L.Transforms.eastNorthUpToFixedFrame(o,r,M),c=L.Matrix4.inverse(u,M),s=V,f=R;f[0].longitude=n.west,f[0].latitude=n.south,f[1].longitude=n.west,f[1].latitude=n.north,f[2].longitude=n.east,f[2].latitude=n.south;var l=q;for(a=0;a<3;a++)v.Cartographic.toCartesian(f[a],r,l),l=L.Matrix4.multiplyByPointAsVector(c,l,l),s[a].x=l.x,s[a].y=l.y;var h=L.Quaternion.fromAxisAngle(v.Cartesian3.UNIT_Z,-t,_),p=L.Matrix3.fromQuaternion(h,W),y=e.length,b=Number.POSITIVE_INFINITY,C=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,m=Number.NEGATIVE_INFINITY;for(a=0;a<y;a++)l=L.Matrix4.multiplyByPointAsVector(c,e[a],l),l=L.Matrix3.multiplyByVector(p,l,l),b=Math.min(b,l.x),C=Math.min(C,l.y),d=Math.max(d,l.x),m=Math.max(m,l.y);var O=A.fromRotation(t,D),k=G;k[0].x=b,k[0].y=C,k[1].x=b,k[1].y=m,k[2].x=d,k[2].y=C;var x=s[0],E=s[2].x-x.x,T=s[1].y-x.y;for(a=0;a<3;a++){var N=k[a];A.multiplyByVector(O,N,N),N.x=(N.x-x.x)/E,N.y=(N.y-x.y)/T}var I=k[0],j=k[1],w=k[2],g=new Array(6);return v.Cartesian2.pack(I,g),v.Cartesian2.pack(j,g,2),v.Cartesian2.pack(w,g,4),g},e.Geometry=h,e.GeometryAttribute=function(e){if(e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT),!i.defined(e.componentDatatype))throw new u.DeveloperError("options.componentDatatype is required.");if(!i.defined(e.componentsPerAttribute))throw new u.DeveloperError("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||4<e.componentsPerAttribute)throw new u.DeveloperError("options.componentsPerAttribute must be between 1 and 4.");if(!i.defined(e.values))throw new u.DeveloperError("options.values is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=a.defaultValue(e.normalize,!1),this.values=e.values},e.GeometryType=o,e.Matrix2=A,e.PrimitiveType=l});
